module: pyeudiw.satosa.backend.OpenID4VPBackend
name: OpenID4VP

config:
  
  ui:
    static_storage_url: "https://localhost:9999"
    template_folder: "templates" # project root
    qrcode_template: "qrcode.html"
    error_template: "error.html"
    error_url: "https://localhost:9999/error_page.html"
  
  endpoints:
      pre_request: '/<name>/pre-request'
      redirect: '/<name>/redirect_uri'
      request: '/<name>/request_uri'
      entity_configuration: '/<name>/.well-known/openid-federation'

  qrcode:
    size: 100
    color: '#2B4375'
    logo_path: 
    use_zlib: false

  jwt:
    default_sig_alg: ES256 # or RS256
    default_exp: 6         # minutes

  authorization:
    url_scheme: "eudiw" # eudiw://
    scopes: 
    - pid-sd-jwt:unique_id+given_name+family_name
    
  federation:
    metadata_type: "wallet_relying_party"
    federation_authorities:
        - https://localhost:8000
    default_sig_alg: "RS256"
    
    # private jwk
    federation_jwks:
      - kty: RSA
        d: QUZsh1NqvpueootsdSjFQz-BUvxwd3Qnzm5qNb-WeOsvt3rWMEv0Q8CZrla2tndHTJhwioo1U4NuQey7znijhZ177bUwPPxSW1r68dEnL2U74nKwwoYeeMdEXnUfZSPxzs7nY6b7vtyCoA-AjiVYFOlgKNAItspv1HxeyGCLhLYhKvS_YoTdAeLuegETU5D6K1xGQIuw0nS13Icjz79Y8jC10TX4FdZwdX-NmuIEDP5-s95V9DMENtVqJAVE3L-wO-NdDilyjyOmAbntgsCzYVGH9U3W_djh4t3qVFCv3r0S-DA2FD3THvlrFi655L0QHR3gu_Fbj3b9Ybtajpue_Q
        e: AQAB
        kid: 9Cquk0X-fNPSdePQIgQcQZtD6J0IjIRrFigW2PPK_-w
        n: utqtxbs-jnK0cPsV7aRkkZKA9t4S-WSZa3nCZtYIKDpgLnR_qcpeF0diJZvKOqXmj2cXaKFUE-8uHKAHo7BL7T-Rj2x3vGESh7SG1pE0thDGlXj4yNsg0qNvCXtk703L2H3i1UXwx6nq1uFxD2EcOE4a6qDYBI16Zl71TUZktJwmOejoHl16CPWqDLGo9GUSk_MmHOV20m4wXWkB4qbvpWVY8H6b2a0rB1B1YPOs5ZLYarSYZgjDEg6DMtZ4NgiwZ-4N1aaLwyO-GLwt9Vf-NBKwoxeRyD3zWE2FXRFBbhKGksMrCGnFDsNl5JTlPjaM3kYyImE941ggcuc495m-Fw
        p: 2zmGXIMCEHPphw778YjVTar1eycih6fFSJ4I4bl1iq167GqO0PjlOx6CZ1-OdBTVU7HfrYRiUK_BnGRdPDn-DQghwwkB79ZdHWL14wXnpB5y-boHz_LxvjsEqXtuQYcIkidOGaMG68XNT1nM4F9a8UKFr5hHYT5_UIQSwsxlRQ0
        q: 2jMFt2iFrdaYabdXuB4QMboVjPvbLA-IVb6_0hSG_-EueGBvgcBxdFGIZaG6kqHqlB7qMsSzdptU0vn6IgmCZnX-Hlt6c5X7JB_q91PZMLTO01pbZ2Bk58GloalCHnw_mjPh0YPviH5jGoWM5RHyl_HDDMI-UeLkzP7ImxGizrM
    
    trust_marks: # todo
    - ...

  # private jwk
  metadata_jwks: 
    - crv: P-256
      d: KzQBowMMoPmSZe7G8QsdEWc1IvR2nsgE8qTOYmMcLtc
      kid: dDwPWXz5sCtczj7CJbqgPGJ2qQ83gZ9Sfs-tJyULi6s
      use: sig
      kty: EC
      x: TSO-KOqdnUj5SUuasdlRB2VVFSqtJOxuR5GftUTuBdk
      y: ByWgQt1wGBSnF56jQqLdoO1xKUynMY-BHIDB3eXlR7
    - kty: RSA
      d: QUZsh1NqvpueootsdSjFQz-BUvxwd3Qnzm5qNb-WeOsvt3rWMEv0Q8CZrla2tndHTJhwioo1U4NuQey7znijhZ177bUwPPxSW1r68dEnL2U74nKwwoYeeMdEXnUfZSPxzs7nY6b7vtyCoA-AjiVYFOlgKNAItspv1HxeyGCLhLYhKvS_YoTdAeLuegETU5D6K1xGQIuw0nS13Icjz79Y8jC10TX4FdZwdX-NmuIEDP5-s95V9DMENtVqJAVE3L-wO-NdDilyjyOmAbntgsCzYVGH9U3W_djh4t3qVFCv3r0S-DA2FD3THvlrFi655L0QHR3gu_Fbj3b9Ybtajpue_Q
      e: AQAB
      use: enc
      kid: 9Cquk0X-fNPSdePQIgQcQZtD6J0IjIRrFigW2PPK_-w
      n: utqtxbs-jnK0cPsV7aRkkZKA9t4S-WSZa3nCZtYIKDpgLnR_qcpeF0diJZvKOqXmj2cXaKFUE-8uHKAHo7BL7T-Rj2x3vGESh7SG1pE0thDGlXj4yNsg0qNvCXtk703L2H3i1UXwx6nq1uFxD2EcOE4a6qDYBI16Zl71TUZktJwmOejoHl16CPWqDLGo9GUSk_MmHOV20m4wXWkB4qbvpWVY8H6b2a0rB1B1YPOs5ZLYarSYZgjDEg6DMtZ4NgiwZ-4N1aaLwyO-GLwt9Vf-NBKwoxeRyD3zWE2FXRFBbhKGksMrCGnFDsNl5JTlPjaM3kYyImE941ggcuc495m-Fw
      p: 2zmGXIMCEHPphw778YjVTar1eycih6fFSJ4I4bl1iq167GqO0PjlOx6CZ1-OdBTVU7HfrYRiUK_BnGRdPDn-DQghwwkB79ZdHWL14wXnpB5y-boHz_LxvjsEqXtuQYcIkidOGaMG68XNT1nM4F9a8UKFr5hHYT5_UIQSwsxlRQ0
      q: 2jMFt2iFrdaYabdXuB4QMboVjPvbLA-IVb6_0hSG_-EueGBvgcBxdFGIZaG6kqHqlB7qMsSzdptU0vn6IgmCZnX-Hlt6c5X7JB_q91PZMLTO01pbZ2Bk58GloalCHnw_mjPh0YPviH5jGoWM5RHyl_HDDMI-UeLkzP7ImxGizrM


  # Mongodb database configuration
  mongo_db_settings:
    cache:
      url: mongodb://localhost:27017/
      conf:
        db_name: eudiw
    storage:
      url: mongodb://localhost:27017/
      conf:
        db_name: eudiw
        db_collection: sessions

  #This is the configuration for the relaying party metadata
  metadata:
    application_type: web

    #The following section contains all the algorithms supported for the encryption of response
    authorization_encrypted_response_alg:
      - RSA-OAEP
      - RSA-OAEP-256
    authorization_encrypted_response_enc:
      - A128CBC-HS256
      - A192CBC-HS384
      - A256CBC-HS512
      - A128GCM
      - A192GCM
      - A256GCM
    authorization_signed_response_alg:
      - RS256
      - ES256

    #Various informations of the client
    client_id: "<base_url>/<name>"
    client_name: Name of an example organization
    contacts:
      - ops@verifier.example.org
    default_acr_values:
      - https://www.spid.gov.it/SpidL2
      - https://www.spid.gov.it/SpidL3

    default_max_age: 1111

    #The following section contains all the algorithms supported for the encryption of id token response
    id_token_encrypted_response_alg:
      - RSA-OAEP
      - RSA-OAEP-256
    id_token_encrypted_response_enc:
      - A128CBC-HS256
      - A192CBC-HS384
      - A256CBC-HS512
      - A128GCM
      - A192GCM
      - A256GCM
    id_token_signed_response_alg:
      - RS256
      - ES256

    # loaded in the __init__
    # jwks:

    #This section contains the details for presentation request
    presentation_definitions:
      - id: pid-sd-jwt:unique_id+given_name+family_name
        input_descriptors:
        - id: pid-sd-jwt:unique_id+given_name+family_name
          format:
            constraints:
              fields:
              - filter:
                  const: PersonIdentificationData
                  type: string
                path:
                - $.sd-jwt.type
              - filter:
                  type: object
                path:
                - $.sd-jwt.cnf
              - intent_to_retain: 'true'
                path:
                - $.sd-jwt.family_name
              - intent_to_retain: 'true'
                path:
                - $.sd-jwt.given_name
              - intent_to_retain: 'true'
                path:
                - $.sd-jwt.unique_id
              limit_disclosure: required
            jwt:
              alg:
              - EdDSA
              - ES256
      - id: mDL-sample-req
        input_descriptors:
        - format:
            constraints:
              fields:
              - filter:
                  const: org.iso.18013.5.1.mDL
                  type: string
                path:
                - $.mdoc.doctype
              - filter:
                  const: org.iso.18013.5.1
                  type: string
                path:
                - $.mdoc.namespace
              - intent_to_retain: 'false'
                path:
                - $.mdoc.family_name
              - intent_to_retain: 'false'
                path:
                - $.mdoc.portrait
              - intent_to_retain: 'false'
                path:
                - $.mdoc.driving_privileges
              limit_disclosure: required
            mso_mdoc:
              alg:
              - EdDSA
              - ES256
          id: mDL

    redirect_uris:
      - <base_url>/<name>/redirect_uri
    request_uris:
      - <base_url>/<name>/request_uri

    require_auth_time: true
    subject_type: pairwise

    vp_formats:
      jwt_vp_json:
        alg:
          - EdDSA
          - ES256K
